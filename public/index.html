<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OCR EasyOCR</title>
<style>
body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; padding: 50px; background: #f9f9f9; }
h1 { margin-bottom: 20px; }
.upload-btn { 
  background-color: #4CAF50; color: white; padding: 15px 25px; border: none; border-radius: 8px; cursor: pointer;
  transition: background 0.3s;
}
.upload-btn:hover { background-color: #45a049; }
input[type=file] { display: none; }
#preview { max-width: 80%; margin-top: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display:none; }
#extractBtn { margin-top: 20px; padding: 10px 20px; display: none; border-radius: 6px; cursor: pointer; background:#2196F3; color:#fff; border:none; transition: background 0.3s; }
#extractBtn:hover { background:#1976D2; }
#loading { display:none; margin-top: 20px; color: #555; }
#result { margin-top: 20px; padding: 15px; border-radius: 6px; background: #f1f1f1; max-width: 80%; word-wrap: break-word; display:none; white-space: pre-wrap; }
</style>
</head>
<body>

<h1>Extrair Texto da Imagem</h1>
<label class="upload-btn" for="imageInput">Escolher Imagem</label>
<input type="file" id="imageInput" accept="image/*">
<img id="preview" src="" alt="Pré-visualização">
<button id="extractBtn">Extrair Texto</button>
<div id="loading">Extraindo texto, aguarde...</div>
<div id="result"></div>

<script>
const imageInput = document.getElementById('imageInput');
const preview = document.getElementById('preview');
const extractBtn = document.getElementById('extractBtn');
const result = document.getElementById('result');
const loading = document.getElementById('loading');

imageInput.addEventListener('change', () => {
  const file = imageInput.files[0];
  if (file) {
    preview.src = URL.createObjectURL(file);
    preview.style.display = 'block';
    extractBtn.style.display = 'inline-block';
    result.style.display = 'none';
  }
});

extractBtn.addEventListener('click', async () => {
  const file = imageInput.files[0];
  if (!file) return;

  const formData = new FormData();
  formData.append('image', file);

  extractBtn.style.display = 'none';
  loading.style.display = 'block';

  try {
    const res = await fetch('/extract-text', { method: 'POST', body: formData });
    const data = await res.json();
    loading.style.display = 'none';
    result.textContent = data.text || 'Nenhum texto encontrado';
    result.style.display = 'block';
  } catch (err) {
    loading.style.display = 'none';
    result.textContent = 'Erro ao processar a imagem';
    result.style.display = 'block';
  } finally {
    extractBtn.style.display = 'inline-block';
  }
});
</script>

</body>
</html>
